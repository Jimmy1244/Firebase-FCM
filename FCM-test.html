<html>
	<head>

	</head>
	<body>
        <div>Hello World!</div>
        <!-- The core Firebase JS SDK is always required and must be listed first -->
        <script src="https://www.gstatic.com/firebasejs/8.0.2/firebase-app.js"></script>
        <script src="https://www.gstatic.com/firebasejs/8.0.2/firebase-messaging.js"></script>

        <!-- TODO: Add SDKs for Firebase products that you want to use
            https://firebase.google.com/docs/web/setup#available-libraries -->

        <script>
        // Your web app's Firebase configuration
        var firebaseConfig = {
            apiKey: "AIzaSyCX30cBMZd48VmGNfGLuk8_-S5l-IQKPF0",
            authDomain: "playground-f317d.firebaseapp.com",
            databaseURL: "https://playground-f317d.firebaseio.com",
            projectId: "playground-f317d",
            storageBucket: "playground-f317d.appspot.com",
            messagingSenderId: "771712858229",
            appId: "1:771712858229:web:33be34ed7570d21ea0203c"
        };
        // Initialize Firebase
        firebase.initializeApp(firebaseConfig);

        const message = firebase.messaging();


        if('serviceWorker' in navigator) {
            console.log('支援sw');
            navigator.serviceWorker.register("這邊放你自訂的 service-worker.js")
            .then(registration => {
                message.useServiceWorker(registration);
                message.requestPermission()
                .then(() => {
                    // getToken();
                    console.log('允許通知')
                })
                .catch(() => {
                    console.log('unable to get permission to notify');
                })
                console.log('成功', registration);
            }).catch(err => {
                console.log('fail', err);
            })
        } else {
            console.log('不支援sw');
        }
        
        message.requestPermission()
            .then(res => {
                // 若允許通知 -> 向 firebase 拿 token
                return message.getToken();
            }, err => {
                // 若拒絕通知
                console.log(err);  
            })
            .then(token => {
                // 成功取得 token
                //postToken(token); // 打給後端 api
                console.log(token);
            });
        </script>
	</body>
</html>